<!doctype html>
<html style="font-size: 2rem;">

<head>
  <!-- Pico CSS -->
  <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@1.*/css/pico.min.css">
  <title>WhatsApp chat with unknown contact</title>
  <meta name="description" content="WhatsApp chat with unknown contact">
</head>

<body>
  <main class="container">
    <h1>WhatsApp chat</h1>
    <h4>Enter an international phone number</h4>
    <form id="whatsapp">
      <input id="phone-input" pattern="[0-9 ]+" type="tel" id="numberField" name="phone"
        placeholder="Example 34680217615" required>
      <button type="submit">Start chatting</button>
    </form>
  </main>
</body>

<script>
  document.getElementById('phone-input').addEventListener('change', (event) => {
    const input = event.target;
    if (input.validity.patternMismatch) {
      input.setCustomValidity('Only numbers and white spaces are allowed');
    } else {
      input.setCustomValidity('');
    }
  }, false);

  const openChat = (phone) => {
    const url =
      (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) ?
        `https://wa.me/${phone}` :
        `https://web.whatsapp.com/send?phone=${phone}&text&type=phone_number`;

    const link = document.createElement("a");
    link.setAttribute("href", url);
    document.body.append(link);
    link.click();
    document.body.removeChild(link);
  };

  const whatsAppForm = document.forms.whatsapp;

  whatsAppForm.addEventListener('submit', (event) => {
    event.preventDefault();
    const formElements = new FormData(whatsAppForm);
    const input = formElements.get('phone').replace(/\s/g, '');

    if (!input) {
      return null;
    }
    return openChat(input);
  });
</script>

</html>